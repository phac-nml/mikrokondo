/*
========================================================================================
    Nextflow config file for running tests
========================================================================================
*/

params.max_memory = "2.GB"
params.max_cpus = 1
params.fastp.args.illumina = "-Q" // Might need to remove this param was not being applied originally
params.fastp.args.single_end = "-Q"

/*  This is required for tests to run in WSL/Ubuntu using singularity
    Without this, ECTyper was not successfully completing.
    More information related to the ECTyper error I encountered
    is found at https://github.com/marcelm/cutadapt/issues/583

    2024-04-18: Updated from contains to containall in a hope to resolve
    an issue with QUAST and gridss after reading through the above issue
    sadly it did not work but apparently containall is a good catchall.

    Bind mounts are passed to mount a modified checksum file in the container
    used by CheckM2. CheckM2 includes a check to verify that the used database
    sha256 checksum matches internal data in the program, binding our file in
    its place tricks the program into running.

*/
singularity.runOptions = "--containall --workdir /tmp -B $baseDir/tests/data/databases/version_hashes_1.1.0.json:/usr/local/lib/python3.12/site-packages/checkm2/version/version_hashes_1.1.0.json"

apptainer.runOptions = "-B $baseDir/tests/data/databases/version_hashes_1.1.0.json:/usr/local/lib/python3.12/site-packages/checkm2/version/version_hashes_1.1.0.json"

docker.runOptions = "-v $baseDir/tests/data/databases/version_hashes_1.1.0.json:/usr/local/lib/python3.12/site-packages/checkm2/version/version_hashes_1.1.0.json"

/* Remove gzipping on JSON output for testing/asserts on file contents */
iridanext.output.path = "${params.outdir}/iridanext.output.json"

params.modules_testdata_base_path = 'https://raw.githubusercontent.com/nf-core/test-datasets/modules/data/'
params.pipelines_testdata_base_path = 'https://raw.githubusercontent.com/nf-core/test-datasets/refs/heads/test'

trace.fields = "task_id,hash,process,tag,name,status,scratch,container,hostname,duration,realtime,%cpu,rss,vmem,rchar,wchar"
